"use strict";(()=>{var e={};e.id=342,e.ids=[342],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6872:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>f,requestAsyncStorage:()=>m,routeModule:()=>g,serverHooks:()=>y,staticGenerationAsyncStorage:()=>h});var i={};r.r(i),r.d(i,{GET:()=>c,POST:()=>d});var s=r(9303),n=r(8716),o=r(3131),a=r(7070),u=r(4184),p=r(679),l=r(6961);async function c(e){try{await (0,u.v)();let{searchParams:t}=new URL(e.url),r=parseInt(t.get("page")||"1"),i=t.get("category"),s=t.get("search"),n=parseInt(t.get("limit")||"9"),o=(r-1)*n,l={published:!0};i&&"All"!==i&&(l.category=i),s&&(l.$or=[{title:{$regex:s,$options:"i"}},{excerpt:{$regex:s,$options:"i"}},{content:{$regex:s,$options:"i"}},{tags:{$in:[RegExp(s,"i")]}}]);let c=await p.Z.find(l).sort({createdAt:-1}).skip(o).limit(n).lean(),d=await p.Z.countDocuments(l),g=await p.Z.distinct("category",{published:!0});return a.NextResponse.json({success:!0,posts:c.map(e=>({...e,id:e._id.toString()})),total:d,page:r,limit:n,totalPages:Math.ceil(d/n),categories:g})}catch(e){return a.NextResponse.json({success:!1,message:"Failed to fetch blog posts"},{status:500})}}async function d(e){try{await (0,u.v)();let{title:t,excerpt:r,content:i,category:s,author:n,tags:o,featured:c=!1}=await e.json();if(!t||!r||!i||!s||!n)return a.NextResponse.json({success:!1,message:"Missing required fields"},{status:400});let d={title:t,excerpt:r,content:i,date:new Date().toISOString().split("T")[0],readTime:`${Math.ceil(i.split(" ").length/200)} min read`,category:s,author:n,slug:(0,l.GD)(t),featured:c,tags:o||[],published:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},g=await p.Z.create(d);return a.NextResponse.json({success:!0,message:"Blog post created successfully",post:{...g.toObject(),id:g._id.toString()}},{status:201})}catch(e){return a.NextResponse.json({success:!1,message:"Failed to create blog post"},{status:500})}}let g=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/blog/route",pathname:"/api/blog",filename:"route",bundlePath:"app/api/blog/route"},resolvedPagePath:"/workspaces/dilipsingh076.github.io/src/app/api/blog/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:m,staticGenerationAsyncStorage:h,serverHooks:y}=g,x="/api/blog/route";function f(){return(0,o.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:h})}},6961:(e,t,r)=>{r.d(t,{GD:()=>s,MW:()=>i,vV:()=>n});let i=[];function s(e){return e.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim()}function n(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}},679:(e,t,r)=>{r.d(t,{Z:()=>o});var i=r(1185),s=r.n(i);let n=new i.Schema({title:{type:String,required:!0,trim:!0},excerpt:{type:String,required:!0,trim:!0},content:{type:String,required:!0},date:{type:String,required:!0},readTime:{type:String,required:!0},category:{type:String,required:!0,trim:!0},author:{type:String,required:!0,trim:!0},slug:{type:String,required:!0,unique:!0,trim:!0},featured:{type:Boolean,default:!1},tags:[{type:String,trim:!0}],image:{type:String,trim:!0},published:{type:Boolean,default:!0},createdAt:{type:String,required:!0},updatedAt:{type:String,required:!0}},{timestamps:!1});n.index({slug:1}),n.index({category:1}),n.index({featured:1}),n.index({published:1}),n.index({tags:1});let o=s().models.Blog||s().model("Blog",n)},4184:(e,t,r)=>{r.d(t,{v:()=>u});var i=r(1185),s=r.n(i);let n=process.env.MONGODB_URI,o=process.env.MONGODB_DB_NAME||"portfolio";if(!n)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let a=global.mongoose||{conn:null,promise:null};async function u(){if(a.conn)return a.conn;a.promise||(a.promise=s().connect(n,{bufferCommands:!1,dbName:o}).then(e=>e));try{a.conn=await a.promise}catch(e){throw a.promise=null,e}return a.conn}global.mongoose||(global.mongoose=a)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[276,972],()=>r(6872));module.exports=i})();